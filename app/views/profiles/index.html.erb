
<h1>Profiles</h1>
<%= search_form_for @q do |f| %>
  <%= f.label :detail %>
  <%= f.select :status_eq, Profile.statuses_i18n.invert.map{|key, value| [key, Profile.statuses[value]]}, { include_blank: '指定なし' }%>
  <%= f.submit "検索" %>
<% end %>

<%= sort_link(@q, :birth_date, "年齢で並べ替え") %>
<%= sort_link(@q, :updated_at, "更新順で並べ替え") %>



<div class="container">
  <div class="row">
  <% @profiles.each do |profile| %>
   <div class="col-md-4">
     <div class="card" style="width: 18rem;">
       <div class="card card_topic prof-card">
         <div class="prof-index-container">
         <div class="prof-index-image">
         <% if profile.image? %>
           <%= image_tag profile.image.url, size: '120x120', class: "rounded-circle" %>
         <% else %>
           <%= image_tag asset_path("no_image.jpg"), size: '120x120', class: "rounded-circle" %>
         <% end %>
         </div>
         </div>
       <div class="card-body">
        <div class="card-wrapper">
          <li><%= profile.name %>/ <% if  profile.birth_date.present? %> <%= (Date.today.strftime('%Y%m%d').to_i - profile.birth_date.strftime('%Y%m%d').to_i) / 10000 %>歳   <% end %></li>
          <li><%= profile.gender %>/<%= profile.address %></li>
          <li><%= profile.status %></li>
          <li><%= profile.detail %></li>
          <li><%= profile.updated_at.strftime("%Y-%m-%d") %></li>
           <td><%= link_to 'Show', profile %></td>
          <% if profile.user_id == current_user.id || current_user.try(:admin?) %>
          <td><%= link_to 'Edit', edit_profile_path(profile) %></td>
          <td><%= link_to 'Destroy', profile, method: :delete, data: { confirm: 'Are you sure?' } %>
           <% end %>
        </div> 
        </div> 

       </div>
     </div>
   </div>
   <% end %>
  </div>
</div>
 
